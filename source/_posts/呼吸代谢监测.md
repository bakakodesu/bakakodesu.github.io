---
title: 呼吸代谢监测
date: 2023-08-28 12:08:38
categories:
- 文章
tags:
- 运动科学
- CEPT
math: true
---

## 系统功能

分析个体呼出气体成分，并计算耗氧速度（摄氧量）$V_{O_2}$ 以及代谢能量 EE。

## 呼吸监测方法介绍

### 道格拉斯袋法

道格拉斯袋法（douglas bags）是最早的开放式（open circuit）间接测量代谢消耗的方法，也是测量代谢消耗的「金标准」[1][2]。

原理很简单，将运动呼出的气体用道格拉斯气袋收集起来，然后测量气袋中气体的体积、$O_2$、$CO_2$ 浓度。之后经过计算就能得出运动中代谢能量消耗。

### 逐步呼吸法

道格拉斯袋法必须在运动完成后进行测量，测得值是一个平均量，无法实时测量，也无法对运动的某个时间节点进行分析。随着计算机的发展，逐步呼吸法（breath by breath）被发明[3]。借助于传感器（对传感器性能和信号处理要求很高）和电脑，可以实现对每次呼出气体的流量、成分进行测量，从而得到实时代谢能量消耗。

### 混合气室法（系统采用）

混合气室法（mixing chamber）[4]是将呼出气体排入到一个 5L 左右的混合室内让其充分混合，通过测量混合室中的气体浓度来计算代谢能量消耗。可以理解为测量几次呼出气体的平均值。主要有 2 个优点：

1. 相较于道格拉斯袋法，混合气室法能实现实时代谢测量（相较于逐步呼吸法没那么实时，视运动量而定）；
2. 相较于逐步呼吸法，虽然时效性没有那么好，但混合气室法更加稳定[5]，信号处理起来更容易[6]，且对传感器的要求不高。

## 系统组成

基于混合气室法的呼吸监测模块由 4 个重要组成部分。

### 非重复呼吸阀/管道

非重复呼吸阀（Non Rebreathing Valve）的作用是保证第二次呼吸不会吸入上一次呼出的气体，否则会造成误差。但实际这个现象不可避免，所以需要保证呼吸阀腔体（也叫死腔，dead space）体积小于 70ml[1]。

此外，死腔体积不能太小，否者会对呼吸造成阻力增加测量时的人体额外能量消耗，WHO 建议呼吸阀的阻力不高于 $300L/min-5cmH_2O$[1]。同理，连接呼吸阀和混合室的管道建议阻力不高于 $300L/min-1.5cmH_2O$。

### 混合室

人体在静息状态下，每分钟的通气量大约为 4-8L，采用 5L 的混合室，意味着静息状态的呼出气体能在 1min 中充满混合室（将混合室原本的气体排出）。

### 传感器

传感器的原则是响应时间越短越好。

#### 响应时间

[传感器的响应时间](https://wonderhoi.com/2023/08/07/传感器的响应时间/)。

#### 传感器清单

[气体流量传感器](https://wonderhoi.com/2023/08/03/气体流量传感器-AFM3000-SFM3000-驱动/)；

[O2浓度传感器](https://wonderhoi.com/2023/08/11/O2-浓度传感器-SEN0496-驱动/)；

[CO2浓度传感器](https://wonderhoi.com/2023/08/11/CO2-浓度传感器-SEN0220-驱动/)。

### 上位机

目前的方案是下位机数据采集 Arduino/C++，上位机数据处理树莓派/Python。

## 数据处理

呼吸代谢监测系统最终会采集到：

1. 呼出或吸入气体流量；
2. 呼出气体中的 $O_2$ 浓度；
3. 呼出气体中的 $CO_2$ 浓度。

之后通过计算可得出摄氧速度（摄氧量） $V_{O_2}$、呼吸商 RQ、代谢能量 EE。

**这里按气体流量传感器采集呼出气体流量计算（采集吸入气体的流量其计算原理是一样的）。**

### 气体流量 ATPS 换算 STPD

气体体积需按标准状态（STPD 状态，$\theta = 0°C$，$\rho = 101.3kPa$ 或 $\rho = 760mmHg$，干燥气体）来计算[7][8]。

由于所收集的气体都是饱和水蒸气（其饱和水蒸气压力是温度的函数），而测量温度为室温条（ATPS 状态，环境温度，环境压力，水蒸气饱和），两者换算系数 $f$ 可利用水蒸气分压计算：

在千帕单位下换算系数为：
$$
f = \frac{273K * (\rho-\rho_{H_2O})}{(273K+\theta)*101.3kPa}
$$
或者在毫米汞柱单位下：
$$
f = \frac{273K * (\rho-\rho_{H_2O})}{(273K+\theta)*760mmHg}
$$
其中：

- $f$ 为标准状态气体体积换算系数；
- $\rho$ 为测得环境的大气压；
- $\rho_{H_2O}$ 为呼出气体饱和水蒸气的分压；
- $\theta$ 为呼出气体的温度（在气体流量计中或用道格拉斯袋时测量的大气温度），单位为摄氏度(°C)。

如果收集到的呼出气体在环境中受热高于 37°C 以上，需用 37°C 的饱和水蒸气压 6.27kPa。如果收集到的呼出气体温度不高于 37°C，其饱和水蒸气压见下表：

20°C~37°C 范围内（间隔为 1°C）饱和水蒸气压力，单位为千帕(kPa)：

| 温度/°C | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 20      | 2.34 | 2.49 | 2.64 | 2.81 | 2.98 | 3.17 | 3.36 | 3.56 | 3.78 | 4.00 |
| 30      | 4.24 | 4.49 | 4.75 | 5.03 | 5.32 | 5.62 | 5.94 | 6.27 | -    | -    |

转换为毫米汞柱(mmHg)：

| 温度/°C | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    |
| ------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 20      | 17.5 | 18.7 | 19.8 | 21.1 | 22.4 | 23.8 | 25.2 | 26.7 | 28.4 | 30.0 |
| 30      | 31.8 | 33.7 | 35.7 | 37.7 | 39.9 | 42.2 | 44.6 | 47.1 | -    | -    |

记气体流量传感器读值（呼出气体流量）为 $V_{E-ATPS}$，单位一般为 L/min。

则标准状态的气体流量为 $V_{E-STPD}=f*V_{E-ATPS}$。

#### BTPS 概念

- STPD 状态，$\theta = 0°C$，$\rho = 101.3kPa$ 或 $\rho = 760mmHg$，干燥气体；
- ATPS 状态，环境温度，环境压力，水蒸气饱和；
- BTPS 状态，身体内环境温度 37°C，环境压力，水蒸气饱和。

三者的转换公式为：
$$
V_{BTPS}=V_{ATPS}*\frac{(273K+37) * (\rho-\rho_{H_2O})}{(273K+\theta)*(\rho-47.1mmHg)}
$$

$$
V_{STPD}=V_{BTPS}*\frac{273K* (\rho-47.1mmHg)}{(273K+37)*760mmHg}
$$

### $V_{O_2}$ 计算

核心关系是人体不会消耗和产生氮气，也就是人体吸入和呼出的 $N_2$ 量是不变的。大气中气体成分可以近似分为 0.03% 的 $CO_2$，20.93% 的 $O_2$ 和 79.04% 的 $N_2$ 以及非常少的稀有气体。

记吸入气体中 $O_2$ 浓度为 $F_IO_2$，$CO_2$ 浓度为 $F_ICO_2$，$N_2$ 浓度为 $F_IN_2$；

记呼出气体中 $O_2$ 浓度为 $F_EO_2$，$CO_2$ 浓度为 $F_ECO_2$，$N_2$ 浓度为 $F_EN_2$。

那么吸入气体流量：
$$
V_{I-STPD}=V_{E-STPD}*\frac{F_EN_2}{F_IN_2}=V_{E-STPD}*\frac{1-F_EO_2-F_ECO_2}{1-F_IO_2-F_ICO_2}
$$
$O_2$ 消耗速度（摄氧量）：
$$
V_{O_2}=V_{I-STPD}*F_IO_2-V_{E-STPD}*F_EO_2
$$
同理 $CO_2$ 产生速度：
$$
V_{CO_2}=V_{E-STPD}*F_ECO_2-V_{I-STPD}*F_ICO_2
$$

#### 最大摄氧量 $V_{O_2max}$

当个体满足以下 4 种条件的任意 3 种即认为达到最大摄氧量标准[9]：

1. $V_{O_2}$ 不随负荷的增加而上升，且个体达到力竭；
2. $V_{O_2}$ 的变化幅度不超过 5% 或 150mL/min 或 2mL/kg/min；
3. 呼吸商大于 1.15；
4. 心率大于 180 次/min。

### RQ、EE计算

呼吸商 RQ 或者呼吸交换率 RER 等于 $\frac{V_{CO_2}}{V_{O_2}}$。根据 RQ 数值查询对应的 O2-kCal/L 数值：

![](https://bakako-1308163928.cos.ap-guangzhou.myqcloud.com/uPic/呼吸代谢监测1.png)


例如 RQ=0.8，那么意味着每消耗 1L 氧气，人体需要代谢 4.801kCal 的能量。那么此时的人体代谢 EE = $V_{O_2}$ * 4.801 kCal/min。

#### 呼吸底物

由上表可以发现，根据 RQ 可以知道当前呼吸代谢底物是以脂肪为主还是以糖类为主。

## 系统校准

系统校准可以采用测量代谢当量 MET 的方法进行。1MET 的耗氧量为 3.5ml/kg/min[10]，在人**静息**状态下测得。

## 参考

[1] [📎Open-circuit respirometry a historical review of portable gas analysis systems.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1689864610603-1d877ddb-18a2-4d7e-881a-5cc99e0757d4.pdf)

[2] [📎a brief historical review of the use of Douglas bags and chemical analyzers.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1689864623935-2727c37e-08b5-4cde-bed8-0ac81d0c527f.pdf)

[3] [📎On-line computer analysis and breath-by-breath graphical display of exercise function tests..pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1689864746920-56963d18-9dce-4cf1-9034-3ad2229d9af5.pdf)

[4] [📎Validity and Stability of a Computerized Metabolic System with Mixing Chamber.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1689864829672-a808cc03-6ed0-4525-8dfa-31de54e3d435.pdf)

[5] [📎Accuracy and precision of CPET equipment A comparison of breath by breath and mixing chamber systems.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1689864864021-dd003bcd-bd70-4c95-888a-7b6223a43b05.pdf)

[6] [Mxing Chamber vs Breath by Breath](https://www.redbackbiotek.com/mixing-chamber)

[7] [📎Metabolic Computations in Open-Circuit Spirometry.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1692113579367-e3ed568b-cb7a-4409-9709-89baabb1a4ae.pdf)

[8] [📎热环境人类工效学 代谢率的测定.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1692113510091-3b4b025d-54f9-42e4-b53e-50f43c2bf02b.pdf)

[9] 《体育院校通用教材/运动生理学》，人民体育出版社，2002

[10]  [📎Resting Oxygen Uptake Value of 1 Metabolic Equivalent of Task in Older Adults A Systematic Review and Descriptive Analysis.pdf](https://www.yuque.com/attachments/yuque/0/2023/pdf/38539471/1692114986255-7fc81d83-22c1-41c8-9b77-4b87cbbbf5d0.pdf)
